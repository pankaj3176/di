{"properties":{},"description":"","processes":{"workflowtrigger1":{"component":"com.sap.dh.trigger","metadata":{"label":"Workflow Trigger","x":12,"y":72,"height":80,"width":120,"extensible":true,"config":{}}},"hanatableconsumer1":{"component":"com.sap.dh.ds.hanaodbc.table.consumer","metadata":{"label":"HANA Table Consumer","x":181,"y":72,"height":80,"width":120,"extensible":false,"config":{"partitionType":"None","hanaConnection":{"configurationType":"Configuration Manager","connectionID":"HANA_CCLOUD"},"adapted_dataset":{"remoteObjectReference":{"connection":{"id":"HANA_CCLOUD","type":"HANA_DB"},"name":"SHA_CELLSTATUS","remoteObjectType":"TABLE","qualifiedName":"/SAPIT/SHA_CELLSTATUS","nativeQualifiedName":"\"SAPIT\".\"SHA_CELLSTATUS\"","owner":"SAPIT"},"schema":{"genericType":"TABLE","tableBasedRepresentation":{"attributes":[{"name":"DATE","templateType":"date","datatype":"DATE","nativeDatatype":"DATE","descriptions":[{"value":"com.sap.core.date","locale":"en","type":"SHORT"}]},{"name":"CELLID","templateType":"int32","datatype":"INTEGER","length":4,"nativeDatatype":"INTEGER","descriptions":[{"value":"com.sap.core.int32","locale":"en","type":"SHORT"}]},{"name":"KEY1","templateType":"float32","datatype":"FLOATING","length":4,"nativeDatatype":"REAL","descriptions":[{"value":"com.sap.core.float32","locale":"en","type":"SHORT"}]},{"name":"KEY2","templateType":"float32","datatype":"FLOATING","length":4,"nativeDatatype":"REAL","descriptions":[{"value":"com.sap.core.float32","locale":"en","type":"SHORT"}]},{"name":"NOM_KEY1","templateType":"float32","datatype":"FLOATING","length":4,"nativeDatatype":"REAL","descriptions":[{"value":"com.sap.core.float32","locale":"en","type":"SHORT"}]},{"name":"NOM_KEY2","templateType":"float32","datatype":"FLOATING","length":4,"nativeDatatype":"REAL","descriptions":[{"value":"com.sap.core.float32","locale":"en","type":"SHORT"}]}]}},"capabilityProperties":[{"name":"isProfileable","value":"true"}]}}}},"flowagentcsvproducer1":{"component":"com.sap.dh.ds.csv.producer","metadata":{"label":"Flowagent CSV Producer","x":365.9999990463257,"y":72,"height":80,"width":120,"extensible":false,"config":{}}},"wiretap1":{"component":"com.sap.util.wiretap","metadata":{"label":"Wiretap","x":550.9999980926514,"y":72,"height":80,"width":120,"ui":"dynpath","config":{}}},"validationrule1":{"component":"com.sap.dh.dq.validationRule","metadata":{"label":"Validation Rule","x":719.9999980926514,"y":71,"height":82,"width":120,"extensible":false,"config":{"inputSchema":[{"name":"DATE","type":"String","length":10},{"name":"CELLID","type":"Integer"},{"name":"NOM_KEY1","type":"Number"},{"name":"NOM_KEY2","type":"Number"},{"name":"KEY1","type":"Number"},{"name":"KEY2","type":"Number"}],"rules":[{"column":"KEY1","condition":"<","failAction":"FAIL","value":"130"},{"column":"KEY1","condition":">","failAction":"FAIL","value":"70"}]}}},"wiretap2":{"component":"com.sap.util.wiretap","metadata":{"label":"Wiretap","x":904.999997138977,"y":12,"height":80,"width":120,"ui":"dynpath","config":{}}},"wiretap3":{"component":"com.sap.util.wiretap","metadata":{"label":"Wiretap","x":904.999997138977,"y":132,"height":80,"width":120,"ui":"dynpath","config":{}}},"python3operator1":{"component":"com.sap.system.python3Operator","metadata":{"label":"Python3 Operator","x":1089.9999961853027,"y":72,"height":80,"width":120,"extensible":true,"config":{"script":"import pandas as pd\nimport io\nfrom datetime import datetime\n\ndef on_input(data):\n\n    # Read data to DataFrame\n    data_stream = io.StringIO(data)\n    df = pd.read_csv(data_stream, names = [\"DATE\",\"CELLID\",\"KEY1\",\"KEY2\",\"NOM_KEY1\",\"NOM_KEY2\",\"ERROR_ACTION\",\"ERROR_COLUMNS\",\"ROW_ID\"] )\n    df.rename(columns={'ERROR ACTION':'ERROR_ACTION', 'ERROR COLUMNS' :'ERROR_COLUMNS', 'ROW ID':'ROW_ID'},inplace=True)\n\n    # Add ticket information\n    df[\"TIMESTAMP\"] = datetime.now()\n    df[\"STATUS\"] = 'open'\n    df[\"COMMENT\"] = 'SHA'\n    df[\"ROW_ID\"] = df[\"ROW_ID\"].astype('int64')\n\n    # resort DataFrame in case of order is important\n    df = df[[\"TIMESTAMP\",\"STATUS\",\"COMMENT\",\"DATE\",\"CELLID\",\"KEY1\",\"KEY2\",\"NOM_KEY1\",\"NOM_KEY2\",\"ERROR_ACTION\",\"ERROR_COLUMNS\",\"ROW_ID\"]]\n\n    api.send(\"ticket\", api.Message(attributes={'data':'FAILED'},body=df.to_csv(index = False,date_format=\"%Y-%m-%d\",header=True)))\n\n\napi.set_port_callback(\"failed\", on_input)"},"additionalinports":[{"name":"input1","type":"any.*"},{"name":"failed","type":"string"}],"additionaloutports":[{"name":"ticket","type":"message"}]}},"wiretap4":{"component":"com.sap.util.wiretap","metadata":{"label":"Wiretap","x":1258.9999961853027,"y":72,"height":80,"width":120,"ui":"dynpath","config":{}}},"saphanaclient1":{"component":"com.sap.hana.client2","metadata":{"label":"SAP HANA Client","x":1443.9999952316284,"y":72,"height":80,"width":120,"config":{"connection":{"configurationType":"Configuration Manager","connectionID":"HANA_CCLOUD"},"tableName":"\"SAPIT\".\"QMTICKET\"","tableColumns":[{"name":"TIMESTAMP","type":"DATE"},{"name":"STATUS","type":"VARCHAR","size":100},{"name":"COMMENT","type":"VARCHAR","size":100},{"name":"DATE","type":"DATE"},{"name":"CELLID","type":"INTEGER"},{"name":"KEY1","type":"VARCHAR","size":100},{"name":"KEY2","type":"VARCHAR","size":100},{"name":"NOM_KEY1","type":"FLOAT","size":32},{"name":"NOM_KEY2","type":"FLOAT","size":32},{"name":"ERROR_ACTION","type":"VARCHAR","size":100},{"name":"ERROR_COLUMNS","type":"VARCHAR","size":100},{"name":"ROW_ID","type":"INTEGER"}],"csvHeader":"Ignore","initTable":"Truncate"}}},"graphterminator1":{"component":"com.sap.util.graphTerminator","metadata":{"label":"Graph Terminator","x":1612.9999952316284,"y":72,"height":80,"width":120,"config":{}}}},"groups":[],"connections":[{"metadata":{"points":"136,112 176,112"},"src":{"port":"output","process":"workflowtrigger1"},"tgt":{"port":"inTableName","process":"hanatableconsumer1"}},{"metadata":{"points":"305,103 332.99999952316284,103 332.99999952316284,112 360.9999990463257,112"},"src":{"port":"outConfig","process":"hanatableconsumer1"},"tgt":{"port":"inConfig","process":"flowagentcsvproducer1"}},{"metadata":{"points":"489.9999990463257,94 517.9999985694885,94 517.9999985694885,112 545.9999980926514,112"},"src":{"port":"outContent","process":"flowagentcsvproducer1"},"tgt":{"port":"in","process":"wiretap1"}},{"metadata":{"points":"674.9999980926514,112 714.9999980926514,112"},"src":{"port":"out","process":"wiretap1"},"tgt":{"port":"in","process":"validationrule1"}},{"metadata":{"points":"843.9999980926514,85 871.9999976158142,85 871.9999976158142,52 899.999997138977,52"},"src":{"port":"pass","process":"validationrule1"},"tgt":{"port":"in","process":"wiretap2"}},{"metadata":{"points":"843.9999980926514,103 871.9999976158142,103 871.9999976158142,172 899.999997138977,172"},"src":{"port":"fail","process":"validationrule1"},"tgt":{"port":"in","process":"wiretap3"}},{"metadata":{"points":"1028.999997138977,172 1056.99999666214,172 1056.99999666214,121 1084.9999961853027,121"},"src":{"port":"out","process":"wiretap3"},"tgt":{"port":"failed","process":"python3operator1"}},{"metadata":{"points":"1213.9999961853027,112 1253.9999961853027,112"},"src":{"port":"ticket","process":"python3operator1"},"tgt":{"port":"in","process":"wiretap4"}},{"metadata":{"points":"1382.9999961853027,112 1410.9999957084656,112 1410.9999957084656,121 1438.9999952316284,121"},"src":{"port":"out","process":"wiretap4"},"tgt":{"port":"data","process":"saphanaclient1"}},{"metadata":{"points":"1567.9999952316284,112 1607.9999952316284,112"},"src":{"port":"result","process":"saphanaclient1"},"tgt":{"port":"stop","process":"graphterminator1"}}],"inports":{},"outports":{}}